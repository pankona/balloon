<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="862px" preserveAspectRatio="none" style="width:599px;height:862px;" version="1.1" viewBox="0 0 599 862" width="599px" zoomAndPan="magnify"><defs><filter height="300%" id="f403opzn9njcg" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="284" y="60"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="291" y="79.3184">Spawner</text><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="361" y="184"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="368" y="203.3184">Factory</text><rect fill="#FFFFFF" filter="url(#f403opzn9njcg)" height="572" style="stroke: #000000; stroke-width: 2.0;" width="564" x="13" y="261"/><rect fill="#FFFFFF" filter="url(#f403opzn9njcg)" height="489" style="stroke: #000000; stroke-width: 2.0;" width="544" x="23" y="337"/><rect fill="#FFFFFF" filter="url(#f403opzn9njcg)" height="92" style="stroke: #000000; stroke-width: 2.0;" width="282" x="145" y="491"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="73" x2="73" y1="50" y2="850"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="181" x2="181" y1="50" y2="850"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="317" x2="317" y1="91.5" y2="850"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="394" x2="394" y1="215.5" y2="850"/><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="42" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="33" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="40" y="22.3184">Main loop</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="47" y="36.3184">(Drive)</text><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="42" style="stroke: #A80036; stroke-width: 1.5;" width="49" x="155" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="162" y="22.3184">Event</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="162" y="36.3184">Queue</text><polygon fill="#A80036" points="272,75,282,79,272,83,276,79" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="278" y1="79" y2="79"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="80.5" y="75.4385">new Spawner(frame counter)</text><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="284" y="60"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="291" y="79.3184">Spawner</text><polygon fill="#A80036" points="84.5,118,74.5,122,84.5,126,80.5,122" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="316.5" y1="122" y2="122"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="90.5" y="118.4385">event subscribe</text><polygon fill="#A80036" points="305.5,145,315.5,149,305.5,153,309.5,149" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="311.5" y1="149" y2="149"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="80.5" y="145.4385">run</text><polygon fill="#A80036" points="192.5,172,182.5,176,192.5,180,188.5,176" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="186.5" x2="316.5" y1="176" y2="176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="198.5" y="172.4385">push(JudgeSpawn)</text><polygon fill="#A80036" points="349,199,359,203,349,207,353,203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="355" y1="203" y2="203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="80.5" y="199.4385">new Factory</text><rect fill="#FEFECE" filter="url(#f403opzn9njcg)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="361" y="184"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="368" y="203.3184">Factory</text><polygon fill="#A80036" points="84.5,242,74.5,246,84.5,250,80.5,246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="393.5" y1="246" y2="246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="90.5" y="242.4385">event subscribe</text><path d="M13,261 L90,261 L90,266 L80,276 L13,276 L13,261 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="572" style="stroke: #000000; stroke-width: 2.0;" width="564" x="13" y="261"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="273.4385">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="105" y="272.6787">[while game scene]</text><polygon fill="#A80036" points="169.5,291,179.5,295,169.5,299,173.5,295" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="175.5" y1="295" y2="295"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="80.5" y="291.4385">fetch events</text><polygon fill="#A80036" points="84.5,318,74.5,322,84.5,326,80.5,322" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="78.5" x2="180.5" y1="322" y2="322"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="90.5" y="318.4385">events</text><path d="M23,337 L100,337 L100,342 L90,352 L23,352 L23,337 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="489" style="stroke: #000000; stroke-width: 2.0;" width="544" x="23" y="337"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="38" y="349.4385">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="115" y="348.6787">[len(events)]</text><rect fill="#EEEEEE" filter="url(#f403opzn9njcg)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="584" x="3" y="371.5"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="587" y1="371.5" y2="371.5"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="587" y1="374.5" y2="374.5"/><rect fill="#EEEEEE" filter="url(#f403opzn9njcg)" height="21" style="stroke: #000000; stroke-width: 2.0;" width="174" x="208" y="362"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="214" y="377.4385">event is JudgeSpawn</text><polygon fill="#A80036" points="305.5,408,315.5,412,305.5,416,309.5,412" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="311.5" y1="412" y2="412"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="80.5" y="408.4385">event publish</text><polygon fill="#A80036" points="382.5,435,392.5,439,382.5,443,386.5,439" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="388.5" y1="439" y2="439"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="80.5" y="435.4385">event publish</text><path d="M399,452 L399,475 L462,475 L462,462 L452,452 L399,452 " fill="#FBFB77" filter="url(#f403opzn9njcg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M452,452 L452,462 L462,462 L452,452 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="405" y="468.4385">ignore</text><path d="M145,491 L214,491 L214,496 L204,506 L145,506 L145,491 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="92" style="stroke: #000000; stroke-width: 2.0;" width="282" x="145" y="491"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="160" y="503.4385">alt</text><path d="M322,511 L322,547 L413,547 L413,521 L403,511 L322,511 " fill="#FBFB77" filter="url(#f403opzn9njcg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M403,511 L403,521 L413,521 L403,511 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="328" y="527.4385">push event</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="328" y="540.4385">in random</text><polygon fill="#A80036" points="192.5,571,182.5,575,192.5,579,188.5,575" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="186.5" x2="316.5" y1="575" y2="575"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="198.5" y="571.4385">push(Spawn)</text><polygon fill="#A80036" points="192.5,605,182.5,609,192.5,613,188.5,609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="186.5" x2="316.5" y1="609" y2="609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="198.5" y="605.4385">push(JudgeSpawn)</text><rect fill="#EEEEEE" filter="url(#f403opzn9njcg)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="584" x="3" y="636.5"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="587" y1="636.5" y2="636.5"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="587" y1="639.5" y2="639.5"/><rect fill="#EEEEEE" filter="url(#f403opzn9njcg)" height="21" style="stroke: #000000; stroke-width: 2.0;" width="134" x="228" y="627"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="234" y="642.4385">event is Spawn</text><polygon fill="#A80036" points="305.5,673,315.5,677,305.5,681,309.5,677" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="311.5" y1="677" y2="677"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="80.5" y="673.4385">event publish</text><path d="M322,690 L322,713 L385,713 L385,700 L375,690 L322,690 " fill="#FBFB77" filter="url(#f403opzn9njcg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M375,690 L375,700 L385,700 L375,690 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="42" x="328" y="706.4385">ignore</text><polygon fill="#A80036" points="382.5,737,392.5,741,382.5,745,386.5,741" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="73.5" x2="388.5" y1="741" y2="741"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="80.5" y="737.4385">event publish</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="394.5" x2="436.5" y1="768" y2="768"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="436.5" x2="436.5" y1="768" y2="781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="395.5" x2="436.5" y1="781" y2="781"/><polygon fill="#A80036" points="405.5,777,395.5,781,405.5,785,401.5,781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="401.5" y="764.4385">spawn()</text><path d="M399,794 L399,817 L553,817 L553,804 L543,794 L399,794 " fill="#FBFB77" filter="url(#f403opzn9njcg)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M543,794 L543,804 L553,804 L543,794 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="405" y="810.4385">spawn a new balloon</text><!--
@startuml

hide footbox

participant "Main loop\n(Drive)" as m
participant "Event\nQueue"       as eq
participant Spawner              as s
participant Factory              as f

create s
m -> s : new Spawner(frame counter)
m <- s : event subscribe
m -> s : run
eq <- s : push(JudgeSpawn)
create f
m -> f : new Factory
m <- f : event subscribe
loop while game scene
  m -> eq : fetch events
  m <- eq : events
  loop len(events)
  == event is JudgeSpawn ==
    m -> s : event publish
    m -> f : event publish
    note right of f : ignore
    alt
      note right of s : push event\nin random
      s -> eq : push(Spawn)
    end
    s -> eq : push(JudgeSpawn)
  == event is Spawn ==
    m -> s : event publish
    note right of s : ignore
    m -> f : event publish
    f -> f : spawn()
    note right of f : spawn a new balloon
  end
end

@enduml

PlantUML version 1.2018.02(Sat Mar 10 02:20:44 JST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_162-b12
Operating System: Linux
OS Version: 4.12.14-1-MANJARO
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>